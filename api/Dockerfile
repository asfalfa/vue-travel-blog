FROM node:16.15 as builder

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm ci

ARG DATABASE_URL
ARG DISCORD_ID
ARG LODESTONE_ID
ARG XIVAPI_KEY
ARG CLIENT_TOKEN

ENV DATABASE_URL=$DATABASE_URL
ENV DISCORD_ID=$DISCORD_ID
ENV LODESTONE_ID=$LODESTONE_ID
ENV XIVAPI_KEY=$XIVAPI_KEY
ENV CLIENT_TOKEN=$CLIENT_TOKEN

COPY . .

EXPOSE 3030

CMD [ "npm", "run", "start" ]
